# 连锁商城

每一个系统都是由很多小的功能单一的模块组成，但是当这种简单的模块达到一定数量的时候，原本简单的系统就变成了复杂系统。

商城在互联网中是一个古老的应用，几乎每一个学计算机的同学都或多或少了解电子商城。作为一个从业十多年的老人，对于电子商城，累计了一些心得，记录下来主要是为了整理思路。很多电商面对的问题，因为在一个团队里面，解题思路可能不由你控制。代码也很可能完全偏离你所构想。所以把这些想法放在一个独立的可以自己掌握的空间里面，反复推敲之后，希望能有所收获。

根据商城业务场景的不同，可以把商城分为平台或者私有电商。不过现在市场上的各种商城系统已经往平台方向发展。主要的原因就是平台更容易挣钱，互联网收取广告费是一个边际成本几乎为零的生意。

笔者为什么要写连锁商城，主要的原因是连锁商城现在看还算是一个比较有挑战的系统。这里要做一个限定，大型连锁电商系统。也就是超过500家连锁门店。在这样的规模下，系统必须要同时实现复杂的权限管理、流程管理和系统性能要求。而相对小型的连锁电商系统，比如一个城市50家连锁小卖部，基本上用常规的手段就能解决系统碰上的问题。

# 典型电商系统抽象

一个典型的电商系统需要包含基本的模块，用户、订单、商品、发货。同时也需要财务、数据分析等其它模块。

# 商城主要概念
## 必要概念

### 商品

繁荣的市场并不看市场上有多少买方，而是看市场能供应多少商品。

不管你现在面对的是个人商城、大型电商、或者平台电商，最基本的要素一定是商品。你的电商平台上可以只提供一个商品，但是你必须要有一个能被销售的东西，否则无法形成交易。

### 用户/买方/消费者

也就是买东西的人。只是站在不一样的角度，叫法不太一样。用户通常是站在商城的角度看，用户比较宽泛，注册到商城就可以被成为用户，无需实际发生过交易。消费者通常是第三方的称呼，而买方是只具体某一次交易的买方。

### 订单

订单是买卖双方的一次交易契约，订单需要记录买方、卖方、交易商品、价格、交付方式、发货方式、售后方式等信息。作为一个合约，订单信息的每一次变动都涉及买卖双方。比如价格挑战需要协商一致，退换货的处理也需要双方协商一致。

### 结算/支付

财务是公司运营的核心组成部分，电商作为一种记账方式，最终核算由财务进行。在进入财务记账系统前，需要一个前置的结算过程。比如财务并不处理商品退货，在交易的账单交给公司财务前，需要做必要的清结算。因为业务经营和财务处理是两个独立的部分，而结算和支付实际属于业务部门，而不是财务部分。

## 核心概念

### 营销工具

营销是商业的重要组成部分，核心解决的问题是信息不对等，促使买方更快做出购物决策。商城通常通常需要配备一些必要的营销工具，当然是否需要营销工具取决于商城本身的定位，因为从交易的角度看，营销其实是一个可选项，而不是交易必要的组成要素。

### 店铺/商家

店铺看上去是核心，实际不是，但是基本上电商都会涉及这个概念。主要是因为电商基本上上是平台电商，不管是淘宝、京东。它们都提供平台服务，也就是第三方商家可以到他们的电商平台去售卖商品，对于平台而言，用户不仅是买方，入住的商家也是他们的用户，或者说商家才是他们真正的客户，直接给平台带来收入的人。当然店铺还出现在另一种电商业态中，那就是连锁零售。典型的案例比如7-11这样的连锁零售上，或者大型的连锁超市沃尔玛。在这样的连锁零售场景中，店铺就是一个独立的经验单元。

### 会员

会员和用户在概念上会混用，但实际上是两个概念。对电商平台而言，用户是一个注册账号，并不是一个具体的人。会员是基于注册账号衍生出来的带有具体平台属性的对象。


# 如何处理大量数据

# 系统垂直整合

## 为什么会出现垂直整合
* 原因一

  平台电商已经走到尽头

* 原因二
  
  供应链追求效率
  
* 原因三
  
  行业整合的必然
  
  
## 困难和挑战都有哪些

复杂的本质是不可约简。在设计一个系统的时候，我们通常都是采用某种方式去抽象系统各个实体模块，然后理清系统结构。可是如果你的系统流程超长，中间环节过多，且随时面临着调整和变化。那么越复杂的系统设计，也就越难以应对变化。企图用一个完美的方案应对系统可能出现的变化，实际上是不可能的。

另一方面的挑战来自于人，也就是参与系统建设的人和使用系统的人。人能处理的复杂度是有上限的，也许你能找一个聪明的开发写一个复杂的系统，但是你几乎不可能找到一群聪明的开发来处理复杂系统。最终团队会落入一个平均能力，然后每个人只能处理整个系统的一下子模块。也就是说你可以找很多人来建设复杂系统，但是这同时会导致所有人都无法有效掌握系统。这个问题只能通过管理手段来解决，无法通过技术手段解决。